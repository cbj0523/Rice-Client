<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <script type="text/javascript" src="../js/bootstrap.js"></script>
    <link rel="stylesheet" href="../css/style.css">
    <title>급식찾기앱</title>
    <script>if (typeof module === 'object') {
            window.module = module; module = undefined;
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>if (window.module) module = window.module;</script>

</head>

<body>
    <div class="header">
        급식조회
    </div>
    <div class="row">
        <div class="col">
            <div class="school_search">
                <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="학교이름을 입력하세요..." aria-label="school_name"
                        aria-describedby="button-addon2">
                    <div class="input-group-append">
                        <button class="btn btn-outline-success" type="button" id="button-addon2"
                            onclick="findSchool()">검색</button>
                    </div>
                </div>
            </div>
        </div>
        <!--https://eonasdan.github.io/bootstrap-datetimepicker/-->
        <div class="col">
            <div class="row">
                <div class="date_selecter">
                    <div class="input-group-append">
                        <input class="date_calender" type="date" id="calender" onchange="getDate()"
                            style="text-align:center;">

                        <button class="btn btn-outline-success date_button">설정</button>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div id="result" class="top"></div>
        </div>
    </div>

    <!--
    <div class="container">
        <hr />
        <div class="row fixed-top">
            <div class="col-sm-12">
                <div class="input-group mb-3">
                    <input type="text" id="schoolinput" class="form-control" placeholder="학교명을 입력하세요..."
                        style="margin-left:5rem;margin-right:0.5rem">
                    <button type="button" class="btn btn-success" style="margin-right:20%"
                        onclick="findSchool()">찾기</button>
                    <input type="date" id="calender" onchange="getDate()" style="text-align:center;">
                    <div class="input-group-append" style="margin-right:5rem">
                        <button class="btn btn-primary">입력</button>
                    </div>
                </div>
            </div>
        </div>
        <hr />
        <div class="row">
            <div class="col-sm-12">
                <div id="result" class="top"></div>
            </div>
        </div>
    </div>
</div>
-->

</body>

<script>

    var nowdate = new Date();
    nowdate = nowdate.toString().split(' ');
    var tyear = nowdate[3];
    var tmonth = nowdate[1];
    var tdate = nowdate[2];
    var schoolname;

    switch (tmonth) {
        case "Jan": tmonth = "01"; break;
        case "Feb": tmonth = "02"; break;
        case "Mar": tmonth = "03"; break;
        case "Apr": tmonth = "04"; break;
        case "May": tmonth = "05"; break;
        case "Jun": tmonth = "06"; break;
        case "Jul": tmonth = "07"; break;
        case "Aug": tmonth = "08"; break;
        case "Sep": tmonth = "09"; break;
        case "Oct": tmonth = "10"; break;
        case "Nov": tmonth = "11"; break;
        case "Dec": tmonth = "12"; break;
    }

    document.getElementById("calender").value = `${tyear}-${tmonth}-${tdate}`;

    function getDate() {
        var data = document.getElementById("calender").value;
        // yyyy-mm-dd
        var dataArr = data.split('-');

        var year = dataArr[0];
        var month = dataArr[1];
        var date = dataArr[2];
    }
    var schoolcode;
    function findSchool() {
        var selected = document.getElementById("schoolinput").value.toString();
        if (selected == null || selected == "" || selected == " ") return;
        document.getElementById("result").innerText = "";
        var schoolfile = jQuery.get('../school.txt', (data) => {
            var schooldata = data.toString().split('\n');
            schooldata.forEach(datas => {
                let pdata = datas.split(",");
                if (pdata.indexOf(selected) != -1) {
                    //$('#result').append(pdata+"<br>");
                    $('#result').append(`<div class="school_result">${pdata}</div><br>`);
                }
                pdata = null;
            })
        });
    }

</script>

</html>